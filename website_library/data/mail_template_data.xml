<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        
        <!-- Email Template for Book Borrowed Confirmation -->
        <record id="email_template_book_borrowed" model="mail.template">
            <field name="name">Book Borrowed Confirmation</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="subject">Book Borrowing Confirmation - {{ object.name }}</field>
            <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <p>Xin chào {{ object.partner_id.name }},</p>
    
    <p>Bạn đã mượn thành công các sách sau từ thư viện:</p>
    
    <table border="1" style="border-collapse: collapse; width: 100%;">
        <tr style="background-color: #f0f0f0;">
            <th style="padding: 8px;">Tên sách</th>
            <th style="padding: 8px;">Số serial</th>
            <th style="padding: 8px;">Hạn trả</th>
        </tr>
        {% for move in object.move_ids %}
        {% for move_line in move.move_line_ids %}
        <tr>
            <td style="padding: 8px;">{{ move.product_id.name }}</td>
            <td style="padding: 8px;">{{ move_line.lot_id.name or 'N/A' }}</td>
            <td style="padding: 8px;">{{ object.borrowing_due_date or 'N/A' }}</td>
        </tr>
        {% endfor %}
        {% endfor %}
    </table>
    
    <p><strong>Lưu ý quan trọng:</strong></p>
    <ul>
        <li>Vui lòng trả sách đúng hạn để tránh phí phạt</li>
        <li>Bạn có thể gia hạn sách trực tuyến nếu không ai đặt trước</li>
        <li>Thông tin trả sách: <a href="/library/return-info">Xem chi tiết</a></li>
    </ul>
    
    <p>Cảm ơn bạn đã sử dụng dịch vụ thư viện!</p>
    
    <p>
        Trân trọng,<br/>
        {{ object.company_id.name }}
    </p>
</div>
            </field>
        </record>

        <!-- Email Template for Book Returned Confirmation -->
        <record id="email_template_book_returned" model="mail.template">
            <field name="name">Book Returned Confirmation</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="subject">Book Return Confirmation - {{ object.name }}</field>
            <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <p>Xin chào {{ object.partner_id.name }},</p>
    
    <p>Cảm ơn bạn đã trả các sách sau về thư viện:</p>
    
    <table border="1" style="border-collapse: collapse; width: 100%;">
        <tr style="background-color: #f0f0f0;">
            <th style="padding: 8px;">Tên sách</th>
            <th style="padding: 8px;">Số serial</th>
            <th style="padding: 8px;">Ngày trả</th>
        </tr>
        {% for move in object.move_ids %}
        {% for move_line in move.move_line_ids %}
        <tr>
            <td style="padding: 8px;">{{ move.product_id.name }}</td>
            <td style="padding: 8px;">{{ move_line.lot_id.name or 'N/A' }}</td>
            <td style="padding: 8px;">{{ object.date_done.strftime('%d/%m/%Y') if object.date_done else 'N/A' }}</td>
        </tr>
        {% endfor %}
        {% endfor %}
    </table>
    
    <p>Các sách đã được nhận và sẽ được đưa trở lại kệ sách.</p>
    
    <p>Bạn có thể tiếp tục mượn sách khác tại: <a href="/library">Thư viện trực tuyến</a></p>
    
    <p>Cảm ơn bạn đã sử dụng dịch vụ thư viện!</p>
    
    <p>
        Trân trọng,<br/>
        {{ object.company_id.name }}
    </p>
</div>
            </field>
        </record>

    </data>
</odoo>